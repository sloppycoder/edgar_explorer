<div class="modal fade" id="trusteeModal" tabindex="-1" aria-labelledby="trusteeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg"> <!-- Use modal-lg for larger width -->
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="trusteeModalLabel">Trustee Compensations</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- Table and Notes -->
                <div id="trusteeTableContainer"></div>
                <p id="trusteeNotes" class="mt-3"></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        var modal = document.getElementById('trusteeModal');
        modal.addEventListener('show.bs.modal', function (event) {
            // Get the link that triggered the modal
            var link = event.relatedTarget;

            // Extract data from the link's data attribute
            var trusteeData = link.getAttribute('data-trustee');

            try {
                // Parse the JSON string into an object
                var parsedData = JSON.parse(trusteeData);

                // Build the table HTML with a narrower "Job Title" column
                var tableHtml = `
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th style="width: 20%;">Job Title</th>
                                <th>Name</th>
                                <th>Fund</th>
                                <th>Fund Group</th>
                                <th>Deferred</th>
                                <th>Other</th>
                            </tr>
                        </thead>
                        <tbody>
                `;

                parsedData.trustees.forEach(trustee => {
                    tableHtml += `
                        <tr>
                            <td>${trustee.job_title}</td>
                            <td>${trustee.name}</td>
                            <td>${trustee.fund_compensation}</td>
                            <td>${trustee.fund_group_compensation}</td>
                            <td>${trustee.deferred_compensation}</td>
                            <td>${trustee.other_compensation.travel_and_expenses || 'N/A'}</td>
                        </tr>
                    `;
                });

                tableHtml += `
                        </tbody>
                    </table>
                `;

                // Insert the table into the modal
                var tableContainer = modal.querySelector('#trusteeTableContainer');
                tableContainer.innerHTML = tableHtml;

                // Add the notes below the table
                var notesElement = modal.querySelector('#trusteeNotes');
                notesElement.textContent = parsedData.notes;
            } catch (error) {
                // Handle errors if the JSON string is invalid
                console.error("Invalid JSON string:", error);

                var tableContainer = modal.querySelector('#trusteeTableContainer');
                var notesElement = modal.querySelector('#trusteeNotes');
                tableContainer.innerHTML = '<p class="text-danger">Unable to load trustee information. Please try again later.</p>';
                notesElement.textContent = '';
            }
        });
    });
</script>
